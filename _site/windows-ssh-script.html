<!DOCTYPE html> <html lang="zh-cmn-Hans"> <head> <meta charset="utf-8" /> <meta http-equiv="X-UA-Compatible" content="IE=edge" /> <title>windows-ssh运行脚本 | znan</title> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.3, user-scalable=no" /> <meta name="description" content="起因 由于经常在windows环境下工作，需要连linux服务器，之前用的xshell过期了，然后其他工具用不习惯，就打算自己开发一个脚本来直接连ssh服务器，故有此文" /> <meta name="keywords" content="ssh, vbs, windows" /> <meta name="author" content="fooleap" /> <meta name="renderer" content="webkit"> <meta http-equiv="Cache-Control" content="no-transform" /> <meta http-equiv="Cache-Control" content="no-siteapp" /> <link rel="canonical" href="https://znan.ml/windows-ssh-script.html" /> <link rel="icon" href="/favicon.ico" /> <link rel="alternate" type="application/atom+xml" title="znan Atom Feed" href="https://blog.fooleap.org/atom.xml" /> <link rel="stylesheet" href="/assets/main.min.css?v=1581150700" /> <script> var ua = navigator.userAgent, head = document.head, site = { home: 'https://znan.ml', api: '', img: '/img', tongji: '9bb4bf149fca98f317e75329260f7961', analytics: 'UA-139257940-1', forum: 'znan', title: "znan" }, page = { layout: 'post', title: 'windows-ssh运行脚本', url: location.pathname, desc: '起因 由于经常在windows环境下工作，需要连linux服务器，之前用的xshell过期了，然后其他工具用不习惯，就打算自己开发一个脚本来直接连ssh服务器，故有此文', id: '/windows-ssh-script', category: 'wiki', tags: ['ssh','vbs','windows'] }, browser = { macos: /Mac/i.test(navigator.platform), windows: /Win/i.test(navigator.platform), mobile: /AppleWebKit.*Mobile.*/i.test(ua), wechat: /MicroMessenger/i.test(ua), }; </script> <script src="/assets/main.min.js?v=1581150700"></script> </head> <body> <div class="page-thumb"> <img src="/img/in-post/thumbs/win.png?imageView2/1/w/300/h/300/q/90" alt="windows-ssh运行脚本"/> </div> <nav class="navigation"> <input class="navigation-toggle" type="checkbox" id="menu" /> <label class="navigation-avatar" for="menu"></label> <label class="navigation-mask" for="menu"></label> <ul class="navigation-list"> <li class="navigation-item "> <a class="navigation-item-link" href="/"><svg class="icon" fill="rgba(160,160,160,1)" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M1024 590.432l-512-397.44-512 397.44 0-162.048 512-397.44 512 397.44zM896 576l0 384-256 0 0-256-256 0 0 256-256 0 0-384 384-288z"></path></svg> 首页</a> </li> <li class="navigation-item"> <a class="navigation-item-link" href="/about.html"><svg class="icon" fill="rgba(160,160,160,1)" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs></defs><path d="M381.362558 958.107176c-5.820845-1.014145-11.720488-1.705933-17.449231-3.097696-37.060812-9.004503-56.26612-35.457214-54.619542-74.927004 1.310918-31.412914 8.87249-61.608035 17.587384-91.612812 14.138677-48.681011 33.749234-95.349082 52.2034-142.439799 26.125237-66.67262 52.459239-133.267465 78.636667-199.919619 2.921679-7.433653 5.263116-15.002388 4.081141-23.259842-1.690583-11.833057-10.512929-18.31499-22.316309-16.01244-14.052715 2.742592-25.166353 10.920224-35.705889 19.89198-18.770383 15.978669-34.158576 35.152254-50.260048 53.668845-11.223137 12.909627-22.857664 25.483593-34.750075 37.782277-4.039183 4.17836-9.03418 7.891093-15.864054 6.115571-9.096605-2.365997-15.918291-12.066382-13.091784-20.922499 2.384418-7.47561 5.978442-14.806928 10.291884-21.379939 12.796034-19.501058 28.9016-36.303529 44.953951-53.113163 25.560345-26.763811 52.946356-51.310011 84.724607-70.617655 35.035592-21.28579 72.467881-35.815388 113.462471-40.148275 20.894868-2.208401 41.731405-2.567598 62.01533 4.402474 29.962819 10.294954 46.384602 31.624748 50.454486 62.638554 3.489642 26.601097-0.737839 52.600462-9.466036 77.550887-20.005572 57.186117-40.826759 114.089787-61.602918 171.004715-18.34262 50.241628-37.132447 100.318495-55.592753 150.517142-4.758602 12.938281-8.880677 26.093513-9.409752 40.053103-0.065495 1.734587-0.058331 3.490665 0.132013 5.212972 1.260774 11.416552 10.115867 17.645715 21.328771 15.046393 8.54911-1.981216 15.69213-6.707071 22.583404-11.813613 18.090875-13.409024 32.858915-30.257546 47.951359-46.747893 13.234031-14.45694 26.183568-29.175859 39.506631-43.549908 3.715803-4.008483 8.22266-7.311874 12.521775-10.745231 3.763901-3.004571 7.763173-2.617743 11.736862-0.184204 7.809224 4.783163 11.49842 14.770087 8.714894 24.416234-3.229709 11.191413-9.591909 20.80072-16.273396 30.096879-28.148411 39.16483-63.036639 71.645104-101.347991 100.53033-33.290771 25.099835-68.908652 46.168674-108.677261 59.558254-17.245583 5.807541-34.859574 9.854911-53.042551 11.265095-1.427581 0.110522-2.830601 0.489164-4.246924 0.741933C394.141195 958.107176 387.752388 958.107176 381.362558 958.107176z"></path><path d="M649.724178 65.892824c8.346486 1.742774 16.967231 2.676074 24.996476 5.368522 35.194212 11.80645 54.915291 37.016807 59.258411 73.354107 6.997703 58.549226-29.637392 108.531945-87.822304 120.375236-25.108022 5.11166-49.768838 2.959543-72.500629-10.162941-22.279468-12.860506-34.594525-32.792397-39.719489-57.585225-9.160053-44.316401 11.179133-90.674395 49.904944-114.211567 15.132355-9.197917 31.323882-14.956338 48.993134-16.480114 0.995725-0.085962 1.966889-0.432879 2.948287-0.659041C640.429042 65.892824 645.076098 65.892824 649.724178 65.892824z"></path></svg> 关于</a> </li> <li class="navigation-item"> <a class="navigation-item-link" href="/archive.html"><svg class="icon" fill="rgba(160,160,160,1)" viewBox="0 0 1110 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="216.796875" height="200"><defs><style type="text/css"></style></defs><path d="M682.765288 469.307255C682.765288 457.752324 678.543291 447.752882 670.099299 439.308929 661.655346 430.864937 651.655904 426.642941 640.100974 426.642941L469.443797 426.642941C457.888867 426.642941 447.889425 430.864937 439.445472 439.308929 431.00148 447.752882 426.779483 457.752324 426.779483 469.307255 426.779483 480.862185 431.00148 490.861627 439.445472 499.30558 447.889425 507.749572 457.888867 511.971569 469.443797 511.971569L640.100974 511.971569C651.655904 511.971569 661.655346 507.749572 670.099299 499.30558 678.543291 490.861627 682.765288 480.862185 682.765288 469.307255ZM1066.743954 341.314352 1066.743954 981.278823C1066.743954 992.833714 1062.521958 1002.833196 1054.077965 1011.277148 1045.634013 1019.721141 1035.634571 1023.943097 1024.07964 1023.943097L85.465131 1023.943097C73.9102 1023.943097 63.910758 1019.721141 55.466806 1011.277148 47.022813 1002.833196 42.800817 992.833714 42.800817 981.278823L42.800817 341.314352C42.800817 329.759461 47.022813 319.76002 55.466806 311.316027 63.910758 302.872035 73.9102 298.650078 85.465131 298.650078L1024.07964 298.650078C1035.634571 298.650078 1045.634013 302.872035 1054.077965 311.316027 1062.521958 319.76002 1066.743954 329.759461 1066.743954 341.314352ZM1109.408228 42.664274 1109.408228 213.32149C1109.408228 224.876381 1105.186272 234.875823 1096.742279 243.319815 1088.298287 251.763768 1078.298845 255.985764 1066.743954 255.985764L42.800817 255.985764C31.245926 255.985764 21.246444 251.763768 12.802492 243.319815 4.358499 234.875823 0.136543 224.876381 0.136543 213.32149L0.136543 42.664274C0.136543 31.109383 4.358499 21.109941 12.802492 12.665949 21.246444 4.221956 31.245926 0 42.800817 0L1066.743954 0C1078.298845 0 1088.298287 4.221956 1096.742279 12.665949 1105.186272 21.109941 1109.408228 31.109383 1109.408228 42.664274ZM1109.408228 42.664274"></path></svg> 归档</a> </li> <li class="navigation-item"> <a class="navigation-item-link" href="/links.html"><svg class="icon" fill="rgba(160,160,160,1)" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M969.344 416.704l-94.656 94.528c-59.008 59.008-146.624 70.848-217.856 36.928l217.856-217.92c25.024-25.024 25.024-65.536 0-90.496L784.256 149.12c-25.024-25.024-65.472-25.024-90.496 0L475.84 367.104C441.92 295.808 453.76 208.192 512.768 149.12l94.464-94.528c75.008-74.944 196.608-74.944 271.488 0l90.624 90.496C1044.224 220.096 1044.224 341.696 969.344 416.704zM331.776 692.16c-25.024-25.024-25.024-65.472 0-90.496l271.488-271.488c25.024-25.024 65.472-25.024 90.496 0s25.024 65.472 0 90.496l-271.488 271.488C397.312 717.184 356.736 717.184 331.776 692.16zM150.72 782.72l90.496 90.496c25.024 25.024 65.472 25.024 90.496 0l217.984-217.984c33.92 71.296 22.08 158.912-36.928 217.984l-86.528 94.528c-75.008 75.008-196.544 75.008-271.552 0l-98.56-98.496c-74.944-75.008-74.944-196.544 0-271.552l94.528-86.528C209.792 452.16 297.344 440.32 368.704 474.24l-217.984 217.92C125.76 717.184 125.76 757.76 150.72 782.72z"></path></svg> 链接</a> </li> <li class="navigation-item"> <a class="navigation-item-link" href="/guestbook.html"><svg class="icon" fill="rgba(160,160,160,1)" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M804.571429 438.857143q0 79.428571-53.714286 146.857143t-146.571429 106.571428T402.285714 731.428571q-49.142857 0-100.571428-9.142857-70.857143 50.285714-158.857143 73.142857-20.571429 5.142857-49.142857 9.142858h-1.714286q-6.285714 0-11.714286-4.571429t-6.571428-12q-0.571429-1.714286-0.571429-3.714286t0.285714-3.714285 1.142858-3.428572l1.428571-2.857143 2-3.142857 2.285714-2.857143 2.571429-2.857143 2.285714-2.571428q2.857143-3.428571 13.142857-14.285714t14.857143-16.857143 12.857143-16.571429 14.285714-22 11.714286-25.142857q-70.857143-41.142857-111.428571-101.142857T0 438.857143q0-79.428571 53.714286-146.857143t146.571428-106.571429T402.285714 146.285714t202 39.142857T750.857143 292t53.714286 146.857143z m219.428571 146.285714q0 68.571429-40.571429 128.285714T872 814.285714q5.714286 13.714286 11.714286 25.142857t14.285714 22 12.857143 16.571429 14.857143 16.857143 13.142857 14.285714q0.571429 0.571429 2.285714 2.571429t2.571429 2.857143 2.285714 2.857142 2 3.142858l1.428571 2.857142 1.142858 3.428572 0.285714 3.714286-0.571429 3.714285q-1.714286 8-7.428571 12.571429t-12.571429 4q-28.571429-4-49.142857-9.142857-88-22.857143-158.857143-73.142857-51.428571 9.142857-100.571428 9.142857-154.857143 0-269.714286-75.428572 33.142857 2.285714 50.285714 2.285715 92 0 176.571429-25.714286t150.857143-73.714286q71.428571-52.571429 109.714285-121.142857t38.285715-145.142857q0-44-13.142857-86.857143 73.714286 40.571429 116.571428 101.714286t42.857143 131.428571z"></path></svg> 留言</a> </li> </ul> </nav> <main class="page-main"> <header class="page-header"> <hgroup class="page-hgroup"> <h1 class="page-title"><a class="page-title-link" href="/windows-ssh-script.html">windows-ssh运行脚本</a> </h1> <h2 class="page-subtitle"> <time class="post-date" datetime="2019-08-12">2019 年 08 月 12 日 </time> <span class="post-count">本文 1048 字，阅读全文约需 3 分钟</span> </h2> </hgroup> </header> <section class="page-content"> <article class="post-content"> <h1 id="id-起因">起因</h1> <p>由于经常在windows环境下工作，需要连linux服务器，之前用的xshell过期了，然后其他工具用不习惯，就打算自己开发一个脚本来直接连ssh服务器，故有此文</p> <h1 id="id-开发环境">开发环境</h1> <ul> <li>ssh命令支持（cmder工具或者openssh+windows自带的cmd均可）</li> <li>vbs环境支持</li> </ul> <p>cmder是一款模仿linux的windows工具，很好用，可以按照这个链接(<a href="https://cmder.net/">cmder工具</a>)来下载学习操作，里面包含ssh，git等工具，不需要额外下载，很方便</p> <p>如果使用自带的cmd，则需要下载openssh，配置ssh环境才能使用，可以按照这个链接(<a href="http://www.mls-software.com/opensshd.html">openssh</a>),拉倒最底下下载</p> <h1 id="id-ssh基本命令">ssh基本命令</h1> <p>用ssh命令行连接linux服务器主要是以下命令</p> <blockquote> <p>ssh username@host</p> </blockquote> <p>输入此命令后再输入密码就可以了，因此脚本的思路也是这样实现，最主要的难点是，如何在windows环境下读取命令行当前的状态，即是否在等待输入密码，对于这个问题，博主尝试了很多办法，比如类似于linux的expect，python脚本等，都无法实现，总会有这样那样的问题，最后是参考<a href="http://www.sixleoluo.me/computer/tech/325/">leoluo同学的vbs脚本</a>实现的</p> <p>linux服务器环境如下(用的是centos虚拟机): <img src="/img/in-post/windows-ssh/server.png" data-url="/img/in-post/windows-ssh/server.png" data-src="/img/in-post/windows-ssh/server.png" alt="server" /> 主要是看ip地址和用户名</p> <p>cmder用ssh连linux服务器操作如图: <img src="/img/in-post/windows-ssh/ssh-connect.png" data-url="/img/in-post/windows-ssh/ssh-connect.png" data-src="/img/in-post/windows-ssh/ssh-connect.png" alt="ssh-connect" /> 第一次连接时，会出现yes/no操作，输入yes即可，然后再输入密码即可</p> <h1 id="id-具体实现">具体实现</h1> <p>根据上面的连接过程，脚本主要代码如下:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set ws = createobject("wscript.shell")    
ws.run "cmder.exe"    
wscript.sleep 800    
ws.SendKeys "+"    
ws.SendKeys "ssh root@192.168.93.128"    
ws.SendKeys "{enter}"    
wscript.sleep 800    
ws.SendKeys "root"     
ws.SendKeys "{enter}"    
</code></pre></div></div> <p>vbs有一个很诡异的地方，就是sendkey操作，默认是跟随系统语言设定输入法的，所以需要在输入命令前切换为英文输入法，即</p> <blockquote> <p>ws.SendKeys “+”</p> </blockquote> <p>具体vbs的相关命令操作，可以参考博文<a href="https://blog.csdn.net/Feiin/article/details/6447684">VBScript中SendKeys的妙用 </a></p> <p>如果你使用的是cmd+openssh的方式的话，需要将</p> <blockquote> <p>ws.run “cmder.exe” 改为 ws.run “cmd.exe”</p> </blockquote> <p>使用的是cmder方式，则需要设置cmder环境变量</p> <h1 id="id-如何使用">如何使用</h1> <p>双击即可，或者可以通过命令行</p> <blockquote> <p>cd vbs脚本所在目录 <br /> wcsript //e:vbscript ssh.vbs</p> </blockquote> </article> <section class="wechat-related"> <div class="wechat-related-item"> <input class="wechat-related-checkbox" type="checkbox" id="wechat-paycode"/> <label class="wechat-related-btn" title="微信赞赏码" for="wechat-paycode"> <svg class="icon" width="19" height="20" viewBox="0 0 19 20" xmlns="http://www.w3.org/2000/svg"><desc>wechat reward.</desc><g><path d="M14.313 7.261l-.032-.004c-.462-.066-.712-.364-.824-.711-.042-.13-.06-.253-.068-.398-.009-.151-.008-.235.001-.645.022-.999-.015-1.624-.194-2.298l-.121-.386-.035-.118c-.044-.196-.184-.549-.437-.895-.44-.602-1.044-.918-1.951-.846-.963.076-1.397.848-1.406 2.11v.009c-.006.908-.022 1.375-.093 1.972-.169 1.421-.593 2.49-1.473 3.132-.617.45-1.61.688-2.962.826-.984.101-1.996.129-2.824.12l-.072-.001c-.153 0-.759.697-.759.95l-.11 7.776c-.044.569.331.917.869.917h10.741c1.054 0 1.88-.147 2.786-.693.52-.314.988-.738 1.396-1.294 1.321-1.803 1.5-3.456 1.085-7.244-.107-.982-1.029-1.976-2.161-2.132l-1.357-.145z" stroke="#434343" fill="none" stroke-width="1.9"/><path d="M9.241 15.058l-.184.044c-.153 0-.286-.084-.356-.208l-.027-.058-1.994-2.273-.02-.085c-.065-.243.221-.556.463-.476l.122.04 1.496.998c.096.063.211.099.334.099l.209-.037 4.601-3.524c.543-.148.661.002.426.529l-5.027 4.926-.045.026z" fill="#434343"/></g></svg> <svg class="icon" width="19" height="20" viewBox="0 0 19 20" xmlns="http://www.w3.org/2000/svg"><desc>wechat reward.</desc><g><path d="M14.313 7.261l-.032-.004c-.462-.066-.712-.364-.824-.711-.042-.13-.06-.253-.068-.398-.009-.151-.008-.235.001-.645.022-.999-.015-1.624-.194-2.298l-.121-.386-.035-.118c-.044-.196-.184-.549-.437-.895-.44-.602-1.044-.918-1.951-.846-.963.076-1.397.848-1.406 2.11v.009c-.006.908-.022 1.375-.093 1.972-.169 1.421-.593 2.49-1.473 3.132-.617.45-1.61.688-2.962.826-.984.101-1.996.129-2.824.12l-.072-.001c-.153 0-.759.697-.759.95l-.11 7.776c-.044.569.331.917.869.917h10.741c1.054 0 1.88-.147 2.786-.693.52-.314.988-.738 1.396-1.294 1.321-1.803 1.5-3.456 1.085-7.244-.107-.982-1.029-1.976-2.161-2.132l-1.357-.145z" stroke="#f46f56" fill="none" stroke-width="1.9"/><path d="M9.241 15.058l-.184.044c-.153 0-.286-.084-.356-.208l-.027-.058-1.994-2.273-.02-.085c-.065-.243.221-.556.463-.476l.122.04 1.496.998c.096.063.211.099.334.099l.209-.037 4.601-3.524c.543-.148.661.002.426.529l-5.027 4.926-.045.026z" fill="#f46f56"/></g></svg> 喜欢作者 </label> <div class="wechat-paycode"></div> </div> </section> <section class="post-extend"> <section class="post-extend-content"> <h4 class="post-extend-title">最近更新</h4> <ul id="recent-posts" class="post-extend-list"> <li class="post-extend-item"> <a class="post-extend-link" href="/manjaro-deepin-wine-wechat.html" title="linux的QQ/微信使用快捷键">linux的QQ/微信使用快捷键</a> </li> <li class="post-extend-item"> <a class="post-extend-link" href="/manjaro-wiki.html" title="manjaro操作系统知识库">manjaro操作系统知识库</a> </li> <li class="post-extend-item"> <a class="post-extend-link" href="/get-github-files.html" title="解决github下载缓慢">解决github下载缓慢</a> </li> <li class="post-extend-item"> <a class="post-extend-link" href="/windows-ssh-script.html" title="windows-ssh运行脚本">windows-ssh运行脚本</a> </li> <li class="post-extend-item"> <a class="post-extend-link" href="/cpp-type-transfer.html" title="cpp-显式类型转换">cpp-显式类型转换</a> </li> </ul> </section> <section class="post-extend-content"> <h4 class="post-extend-title">猜你喜欢</h4> <ul id="random-posts" class="post-extend-list"> </ul> </section> </section> <section class="post-info"> <div class="post-tags"> <div class="post-source"> <svg class="icon" style="" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14968" xmlns:xlink="http://www.w3.org/1999/xlink" width="200.1953125" height="200"><defs><style type="text/css"></style></defs><path d="M293.0688 755.2c-12.0832 0-24.2688-4.2496-33.9968-12.9024L0 512l273.4592-243.0976C294.5536 250.2144 326.912 252.0064 345.7024 273.152c18.7904 21.1456 16.896 53.504-4.2496 72.2944L154.112 512l172.9536 153.7024c21.1456 18.7904 23.04 51.1488 4.2496 72.2944C321.2288 749.4144 307.1488 755.2 293.0688 755.2zM751.0528 755.0976 1024.512 512l-259.072-230.2976c-21.1456-18.7904-53.504-16.896-72.2432 4.2496-18.7904 21.1456-16.896 53.504 4.2496 72.2944L870.4 512l-187.3408 166.5024c-21.1456 18.7904-23.04 51.1488-4.2496 72.2944C688.896 762.2144 702.976 768 717.056 768 729.1392 768 741.3248 763.7504 751.0528 755.0976zM511.5392 827.648l102.4-614.4c4.6592-27.904-14.1824-54.272-42.0864-58.9312-28.0064-4.7104-54.3232 14.1824-58.88 42.0864l-102.4 614.4c-4.6592 27.904 14.1824 54.272 42.0864 58.9312C455.5264 870.1952 458.2912 870.4 461.1072 870.4 485.6832 870.4 507.392 852.6336 511.5392 827.648z"></path></svg> <a class="post-source-button" target="_blank" title="windows-ssh运行脚本" href="https://raw.githubusercontent.com/znfang/znfang.github.io/master/_posts/2019-08-12-windows-ssh-script.md">源码</a> </div> <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M223.94391 322.758961c13.423731-13.414521 20.394493-30.05041 20.394493-48.830125 0-18.780739-6.971785-34.886555-20.394493-48.301076-13.414521-13.414521-29.512151-20.385283-48.291866-20.385283-18.780739 0-35.415604 6.971785-48.830125 20.385283-13.414521 13.414521-19.857257 29.521361-19.857257 48.301076 0 18.779715 6.441713 35.415604 19.857257 48.830125 13.413498 13.413498 30.049387 19.856233 48.830125 19.856233C194.431759 342.616218 210.529389 336.173482 223.94391 322.758961L223.94391 322.758961zM816.895617 583.016427c0 18.780739-6.435573 34.876322-19.848047 48.28982L533.567713 895.313106c-13.951757 13.413498-30.049387 19.857257-48.829102 19.857257-18.780739 0-34.877345-6.443759-48.291866-19.857257L52.769342 511.106654c-13.413498-13.413498-25.222451-31.125905-34.877345-54.19532-9.124821-23.078625-13.95278-44.002167-13.95278-62.782905l0-223.234247c0-18.780739 6.971785-34.877345 20.395516-48.290843C37.749254 109.187795 53.846884 102.217033 72.627622 102.217033L295.851637 102.217033c18.780739 0 39.714514 4.826935 62.782905 14.481829 23.078625 9.124821 41.320081 20.933775 54.733579 34.348296l383.678426 383.128911C810.460044 548.128849 816.895617 564.226478 816.895617 583.016427L816.895617 583.016427zM1022.954693 583.016427c0 18.780739-6.442736 34.876322-19.857257 48.28982L739.628836 895.313106c-13.95278 13.413498-30.049387 19.857257-48.829102 19.857257-25.762757 0-38.636972-9.654894-60.099796-31.655977l252.197906-252.209162c13.414521-13.413498 19.857257-29.510104 19.857257-48.28982 0-18.788925-6.442736-34.887578-19.857257-48.840358l-383.668193-383.128911c-13.414521-13.414521-31.665187-25.222451-54.734602-34.348296-23.078625-9.654894-44.002167-14.481829-62.782905-14.481829l120.199593 0c18.780739 0 39.70428 4.826935 62.782905 14.481829 23.069415 9.124821 41.321104 20.933775 54.733579 34.348296l383.668193 383.128911C1016.511957 548.128849 1022.954693 564.226478 1022.954693 583.016427z"></path></svg> <ul class="post-tag-list"><li class="post-tag-item"><a class="post-tag-link" href="/tags.html?keyword=ssh" target="_blank" title="查看“ssh”的相关文章">ssh</a></li><li class="post-tag-item"><a class="post-tag-link" href="/tags.html?keyword=vbs" target="_blank" title="查看“vbs”的相关文章">vbs</a></li><li class="post-tag-item"><a class="post-tag-link" href="/tags.html?keyword=windows" target="_blank" title="查看“windows”的相关文章">windows</a></li></ul> </div> <div class="post-share"> <input class="post-qrcode-input" type="checkbox" id="qrcode-toggle" /> <div class="post-qrcode" id="qrcode" data-qrcode-url="https://znan.ml/windows-ssh-script.html"></div> <label class="post-share-item wechat" title="分享到微信" for="qrcode-toggle"> <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M308.73856 119.23456C23.65696 170.15296-71.37024 492.23936 155.392 639.66464c12.43392 7.99232 12.43392 7.104-6.21824 62.76096l-15.98464 47.65952 57.43104-30.784 57.43104-30.78656 30.49216 7.40096c31.96928 7.99232 72.82432 13.61664 100.0576 13.61664l16.28416 0-5.62688-21.61152c-44.70016-164.5952 109.82912-327.71072 310.8352-327.71072l27.2384 0-5.62432-19.53792C677.59616 186.43456 491.392 86.67136 308.73856 119.23456zM283.87072 263.40352c30.1952 20.4288 31.97184 64.5376 2.95936 83.48416-47.06816 30.78656-102.1312-23.38816-70.45632-69.57056C230.28736 256.59648 263.74144 249.78688 283.87072 263.40352zM526.62016 263.40352c49.73568 33.45408 12.43392 110.71744-43.22304 89.40288-40.25856-15.39328-44.99712-70.75072-7.40096-90.5856C490.79808 254.22848 513.88928 254.81984 526.62016 263.40352zM636.44928 385.37216c-141.2096 25.7536-239.19872 132.91776-233.57184 256.06656 7.40096 164.89472 200.71168 278.56896 386.32448 227.65312l21.90592-5.92128 46.1824 24.8704c25.4592 13.9136 46.77376 23.97696 47.36512 22.79168 0.59392-1.47968-4.43648-19.24352-10.95168-39.6672-14.79936-45.59104-15.09632-42.33472 4.73856-56.54272C1121.64864 654.464 925.67552 332.97408 636.44928 385.37216zM630.82496 518.28992c12.4288 8.28928 18.944 29.01248 13.61408 44.1088-11.24864 32.26624-59.49952 34.63424-72.52992 3.55328C557.10976 530.13248 597.9648 496.97536 630.82496 518.28992zM828.57472 521.84576c19.53792 18.64704 16.2816 50.32448-6.51264 62.16448-34.93376 17.76128-71.63904-17.76128-53.58336-51.80416C780.32128 510.2976 810.81344 504.97024 828.57472 521.84576z"></path></svg> </label> <a class="post-share-item weibo" target="_blank" title="分享到微博" href="http://service.weibo.com/share/share.php?title=windows-ssh运行脚本 | znan via @znan&amp;url=https://znan.ml/windows-ssh-script.html&amp;type=3&amp;searchPic=1"> <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M671.750827 136.410453c-29.5424 12.926293-36.317867 43.700907-14.769493 65.245867 10.461867 10.46528 20.309333 12.311893 63.39584 12.311893 60.32384 0 100.949333 16.001707 131.730773 51.705173 37.546667 42.472107 41.854293 55.3984 41.854293 132.95616 0 68.939093 0 70.171307 16.001707 79.404373 36.932267 20.927147 61.556053-4.92544 70.171307-73.864533 11.07968-89.869653-42.468693-194.512213-123.101867-242.52416C804.092587 130.870613 713.60512 118.55872 671.750827 136.410453L671.750827 136.410453zM368.90624 250.90048c-68.942507 24.620373-135.420587 72.01792-206.820693 148.343467C-7.18848 578.983253 3.8912 750.103893 190.399147 841.198933c193.8944 94.79168 454.884693 63.399253 597.07392-72.014507 106.48576-100.952747 93.56288-227.754667-27.6992-270.841173-21.548373-7.386453-28.317013-12.926293-25.2416-19.698347 11.07968-27.081387 14.772907-58.473813 8.618667-76.939947-19.083947-58.477227-88.63744-72.01792-192.047787-36.932267l-41.243307 14.155093 3.693227-41.239893c4.31104-48.626347-6.15424-75.096747-35.085653-89.869653C454.464853 235.50976 408.29952 236.741973 368.90624 250.90048L368.90624 250.90048zM540.02688 489.1136c91.712853 25.2416 147.729067 80.636587 147.729067 146.496853 0 73.250133-65.24928 139.113813-171.124053 174.199467-56.6272 18.466133-161.88416 22.15936-213.589333 8.000853-97.870507-27.695787-153.268907-81.861973-153.268907-151.422293 0-38.16448 16.61952-71.400107 52.937387-105.253547 33.85344-32.006827 59.706027-47.40096 109.564587-64.017067C387.372373 471.87968 468.00896 468.800853 540.02688 489.1136zM346.129067 548.819627c-62.16704 28.934827-95.40608 73.250133-95.40608 128.64512 0 50.479787 22.15936 84.947627 70.785707 110.800213 37.546667 20.312747 106.489173 18.466133 148.34688-3.075413 53.551787-28.317013 88.63744-80.636587 88.63744-131.730773-0.621227-41.854293-37.55008-91.712853-81.250987-109.561173C442.156373 529.128107 383.061333 531.585707 346.129067 548.819627L346.129067 548.819627zM391.0656 664.538453c4.307627 4.31104 7.386453 14.772907 7.386453 24.005973 0 30.78144-51.705173 56.016213-72.635733 35.085653-11.69408-11.69408-8.615253-40.625493 4.92544-54.166187C344.282453 655.9232 379.368107 652.847787 391.0656 664.538453zM682.216107 262.59456c-28.317013 28.317013-9.233067 62.170453 35.700053 62.170453 38.775467 0 56.009387 19.698347 56.009387 64.017067 0 27.6992 2.46784 35.700053 13.54752 43.086507 33.23904 23.391573 60.32384-2.461013 60.32384-57.245013 0-67.09248-48.01536-117.568853-116.340053-122.494293C700.678827 249.668267 693.295787 251.51488 682.216107 262.59456L682.216107 262.59456z"></path></svg> </a> <a class="post-share-item qzone" target="_blank" title="分享到 QQ 空间" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://znan.ml/windows-ssh-script.html&amp;title=windows-ssh运行脚本 | znan&amp;summary=&amp;site=https://znan.ml"> <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M505.429333 60.422827c-4.666027 1.908053-17.810773 15.899307-17.810773 19.080533 0 1.058133-20.565333 44.735147-45.79328 96.887467-25.227947 52.155733-46.854827 97.737387-48.124587 101.338453-1.061547 3.392853-2.9696 7.420587-3.816107 8.69376-1.061547 1.273173-6.997333 12.721493-13.356373 25.439573-6.785707 13.994667-13.994667 25.654613-18.0224 28.83584-9.751893 8.267093-3.181227 7.420587-198.44096 29.25568-88.193707 9.96352-97.9456 11.44832-103.246507 16.325973-3.816107 3.38944-5.300907 15.68768-2.542933 22.89664 0.846507 1.908053 38.795947 37.94944 84.3776 80.13824 144.165547 133.137067 134.836907 123.81184 134.836907 133.778773 0 4.87424-2.966187 22.469973-6.35904 39.43424-3.60448 16.960853-11.659947 59.364693-18.234027 94.344533-6.570667 34.983253-14.20288 75.04896-16.960853 89.043627-14.626133 74.625707-14.841173 76.745387-7.205547 84.804267 7.205547 7.632213 15.476053 6.782293 37.311147-4.235947 20.353707-10.3936 22.26176-11.44832 62.33088-34.986667 14.629547-8.47872 33.71008-19.503787 42.400427-24.38144 8.69376-4.87424 24.804693-14.414507 35.618133-20.985173s20.14208-11.874987 20.77696-11.874987c0.423253 0 6.997333-3.816107 14.41792-8.482133 7.420587-4.662613 14.20288-8.475307 15.0528-8.475307 0.846507 0 8.47872-4.23936 16.960853-9.540267 20.138667-12.51328 37.522773-18.868907 47.489707-16.964267 4.235947 0.846507 14.414507 4.877653 22.473387 9.32864 21.200213 11.236693 154.763947 88.193707 196.317867 112.9984 35.406507 21.200213 45.79328 25.23136 57.879893 22.04672 8.055467-1.908053 10.386773-13.568 7.632213-36.672853-1.273173-10.3936-3.181227-22.053547-4.242773-26.08128-1.696427-6.785707-8.690347-44.305067-25.6512-138.441387-7.847253-44.735147-7.847253-45.581653 9.74848-52.15232 24.384853-9.117013 35.82976-17.17248 31.378773-21.62688-1.4848-1.488213-15.0528 0.21504-43.250347 5.300907-52.36736 9.540267-63.1808 11.025067-118.514347 16.114347-62.96576 5.9392-121.060693 7.205547-198.656 4.4544-60.634453-2.11968-132.717227-7.420587-136.74496-9.96352-3.177813-2.123093-1.696427-8.697173 3.181227-12.93312 2.542933-2.338133 34.768213-25.442987 71.447893-51.51744 114.906453-81.414827 189.535573-135.263573 195.682987-140.991147 10.5984-9.96352 9.751893-10.386773-34.348373-16.110933-69.751467-8.905387-87.985493-10.390187-201.622187-15.691093-37.94944-1.693013-72.2944-3.816107-76.322133-4.450987-41.55392-6.997333 170.243413-26.077867 259.710293-23.319893 58.7264 1.696427 127.842987 6.570667 168.546987 11.871573 37.94944 5.08928 40.280747 5.512533 40.280747 9.751893 0 3.392853-4.027733 6.362453-93.279573 67.843413-36.67968 25.442987-75.687253 52.36736-86.71232 60.002987-10.81344 7.6288-22.04672 15.47264-24.593067 17.169067-11.874987 8.055467-51.729067 35.82976-62.754133 43.881813-6.99392 5.085867-12.506453 10.5984-12.506453 12.29824 0 4.031147 10.386773 6.577493 42.400427 10.390187 85.01248 9.96352 243.172693 15.476053 250.170027 8.47872 1.4848-1.488213 1.26976-6.147413-1.06496-15.899307-1.693013-7.420587-3.177813-14.421333-3.177813-15.476053 0-2.9696 36.0448-39.010987 85.8624-85.650773 131.652267-123.392 134.62528-126.358187 134.62528-136.11008 0-8.482133-7.000747-16.114347-17.38752-18.65728-5.085867-1.273173-35.406507-4.666027-67.42016-7.84384-32.013653-2.9696-67.416747-6.362453-78.4384-7.420587-11.025067-1.273173-34.348373-3.60448-51.944107-5.512533-67.208533-6.785707-87.773867-9.32864-92.648107-11.659947-9.32864-4.23936-18.0224-21.62688-82.264747-166.21568-45.79328-103.458133-49.821013-111.72864-56.180053-117.4528C519.420587 59.999573 511.153493 58.09152 505.429333 60.422827L505.429333 60.422827z"></path></svg> </a> <a class="post-share-item twitter" target="_blank" title="Share to Twitter" href="https://twitter.com/intent/tweet?url=https://znan.ml/windows-ssh-script.html&amp;text=windows-ssh运行脚本｜znan&amp;via=znan"> <svg class="icon" style="" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200.1953125" height="200"><defs><style type="text/css"></style></defs><path d="M1024.032 194.432c-37.664 16.704-78.176 28-120.672 33.088 43.36-26.016 76.672-67.168 92.384-116.224-40.608 24.064-85.568 41.568-133.408 50.976-38.336-40.832-92.928-66.336-153.344-66.336-116.032 0-210.08 94.048-210.08 210.08 0 16.48 1.856 32.512 5.44 47.872-174.592-8.768-329.408-92.416-433.024-219.52-18.08 31.04-28.448 67.104-28.448 105.632 0 72.896 37.088 137.184 93.472 174.88-34.432-1.088-66.816-10.528-95.168-26.272-0.032 0.864-0.032 1.76-0.032 2.656 0 101.792 72.416 186.688 168.512 205.984-17.632 4.8-36.192 7.36-55.36 7.36-13.536 0-26.688-1.312-39.52-3.776 26.72 83.456 104.32 144.192 196.256 145.888-71.904 56.352-162.496 89.92-260.928 89.92-16.96 0-33.664-0.992-50.112-2.944 92.96 59.616 203.392 94.4 322.048 94.4 386.432 0 597.728-320.128 597.728-597.76 0-9.12-0.192-18.176-0.608-27.168 41.056-29.632 76.672-66.624 104.832-108.736z"></path></svg> </a> <a class="post-share-item facebook" target="_blank" title="Share to Facebook" href="http://www.facebook.com/sharer.php?u=https://znan.ml/windows-ssh-script.html&amp;t=windows-ssh运行脚本 | znan"> <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M681.8161 612.2455c33.9272 0 67.6229-0.3717 101.2951 0.2324 10.0792 0.1403 15.0456-3.0188 16.3011-13.0621 4.8302-38.1071 9.986-76.1682 14.8634-114.2528 0.3246-2.6931-0.6062-5.5255-1.1858-10.1939-44.0515 0-87.4988 0-130.4852 0 0-38.5024-2.2036-75.1698 0.7905-111.4194 1.9978-24.5699 23.8275-36.7841 57.2672-37.6433 26.1007-0.6963 52.2476-0.1393 79.6979-0.1393 0-41.6143 0-81.5329 0-124.6321-21.3647-1.579-43.1473-4.9234-64.8602-4.4124-32.9974 0.766-67.0638-0.3021-98.6952 7.4547-70.3836 17.2534-114.9942 77.9786-116.5957 151.8715-0.8591 38.4553-0.1618 76.9096-0.1618 117.5962-6.9898 0.4178-13.0744 1.067-19.158 1.0916-27.4012 0.1157-54.828 0.3942-82.2292-0.1178-10.752-0.2089-16.2785 2.6941-16.1628 14.4906 0.3482 36.1564 0.3246 72.3139 0.0225 108.4692-0.1157 11.4606 4.8312 14.9903 15.8843 14.804 33.1141-0.511 66.2292-0.1853 100.3663-0.1853 0 115.2266 0 228.6428 0 343.4527-158.0483 0-315.6787 0-474.6568 0 0-296.4992 0-593.0076 0-890.8052 296.4736 0 592.9492 0 890.8155 0 0 296.3343 0 592.8202 0 890.9425-4.6213 0.3717-9.6358 1.1151-14.6289 1.1602-81.0691 0.0481-162.1125-0.0901-243.159 0.2335-11.052 0.0471-17.3681-1.5299-17.321-14.8152 0.3482-107.2855 0.2079-214.569 0.2785-321.9016C680.0998 618.282 680.9805 616.0998 681.8161 612.2455z"></path></svg> </a> <a class="post-share-item gplus" target="_blank" title="Share to Google+" href="https://plus.google.com/share?url=https://znan.ml/windows-ssh-script.html"> <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M512 0C229.184 0 0 229.184 0 512s229.184 512 512 512 512-229.216 512-512S794.784 0 512 0z m-128 768c-141.6 0-256-114.4-256-256s114.4-256 256-256c69.184 0 127.008 25.184 171.616 67.008l-69.6 66.816c-19.008-18.208-52.192-39.392-102.016-39.392-87.392 0-158.816 72.416-158.816 161.6s71.392 161.6 158.816 161.6c101.408 0 139.392-72.8 145.216-110.4h-145.184v-87.808h241.792c2.208 12.8 4 25.6 4 42.4 0 146.4-98.016 250.208-245.792 250.208z m448-256v64h-64v-64h-64v-64h64v-64h64v64h64v64h-64z"></path></svg> </a> </div> </section> <div class="comment-tips"> 若要显示留言请先搭梯子。与本文不相关的留言，请发<a href=/guestbook>留言版</a>谢谢。 </div> <div id="comment"></div> <!-- disqus 评论框 start --> <div class="comment"> <div id="disqus_thread" class="disqus-thread"></div> </div> <!-- disqus 评论框 end --> <!-- disqus 公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> /* * * CONFIGURATION VARIABLES * * */ var disqus_shortname = "znfang"; var disqus_identifier = "/windows-ssh-script"; var disqus_url = "http://0.0.0.0:5678/windows-ssh-script.html"; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <!-- disqus 公共JS代码 end --> </section> <footer class="page-footer"> <!-- Footer --> <footer> <div class="container" style="font-size: smaller;"> <div class="row"> <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"> <p class="copyright text-muted"> Copyright 2020 <i class="fa fa-heart" aria-hidden="true" style="color: #0085A1"></i> znan. Powered by Jekyll&GitHub.</span> 您是本站第<span id="busuanzi_value_site_uv"></span>位小伙伴</p> <p class="copyright text-muted" id="count"> </p> </div> </div> </div> </footer> <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> <script> //日期计算有点问题，实际是从5月1日开始的，但是计时不对，提前一个月，计时器就是对的 window.setInterval('counter()',1000); function counter(){ var date=new Date(); var startDate=new Date(2019,4,1,0,0,0); var time=(date-startDate)/1000; var day=Math.floor(time/(24*60*60)); var hour=Math.floor(time%(24*60*60)/(60*60)); var minute=Math.floor(time%(24*60*60)%(60*60)/60); var second=Math.floor(time%(24*60*60)%(60*60)%60); var str="我的博客已默默运行了" + day + "天" + hour +"时" + minute + "分" + second + "秒"; document.getElementById('count').innerHTML=str; } </script> </footer> </main> </body> </html>
